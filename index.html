<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>YiTalk - Simultaneous Interpretation</title>
    <!-- Pinyin Library (jsDelivr for better China access) -->
    <script src="https://cdn.jsdelivr.net/npm/pinyin-pro@3.18.2/dist/index.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <header>
        <div class="brand">
            <img src="./logo.png" alt="YiTalk Logo" class="logo">
            <h1>YiTalk</h1>
        </div>
        <button id="settingsBtn" class="icon-btn" aria-label="Settings">
            <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24" fill="currentColor">
                <path
                    d="M480-160q-33 0-56.5-23.5T400-240q0-33 23.5-56.5T480-320q33 0 56.5 23.5T560-240q0 33-23.5 56.5T480-160Zm-56-160v-80h112v80H424Zm56-160q-33 0-56.5-23.5T400-560q0-33 23.5-56.5T480-640q33 0 56.5 23.5T560-560q0 33-23.5 56.5T480-480Z" />
                <path
                    d="m370-80-16-128q-13-5-24.5-12T307-235l-119 50L78-364l104-78q-1-9-2-17t-1-17q0-9 1-17t2-17l-104-78 110-189 119 50q11-8 23-15t24-12l16-128h220l16 128q13 5 24.5 12t22.5 15l119-50 110 189-104 78q1 9 2 17t1 17q0 9-1 17t-2 17l104 78-110 189-119-50q-11 8-23 15t-24 12l-16 128H370Zm62-120q66 0 113-47t47-113q0-66-47-113t-113-47q-66 0-113 47t-47 113q0 66 47 113t113 47Z" />
            </svg>
        </button>
    </header>

    <main id="outputContainer">
        <div id="welcomeMessage" class="message-card system-message">
            <p>マイクボタンを押して、中国語で話しかけてください。<br>設定からDeepSeek APIキーを入力すると、高精度の翻訳が利用できます。</p>
        </div>
        <!-- Dynamic content will be injected here -->
    </main>

    <div class="controls">
        <button id="micBtn" class="mic-btn">
            <div class="mic-icon">
                <svg xmlns="http://www.w3.org/2000/svg" height="32" viewBox="0 -960 960 960" width="32"
                    fill="currentColor">
                    <path
                        d="M480-400q-50 0-85-35t-35-85v-240q0-50 35-85t85-35q50 0 85 35t35 85v240q0 50-35 85t-85 35Z" />
                    <path
                        d="M440-160v-123q-106-15-173-94.5T200-560h80q0 83 58.5 141.5T480-360q83 0 141.5-58.5T680-560h80q0 102-67 182.5T520-283v123h-80Z" />
                </svg>
            </div>
            <span class="mic-status">START</span>
        </button>
    </div>

    <dialog id="settingsDialog">
        <form method="dialog">
            <h2>Settings / 設定</h2>

            <label for="apiKey">DeepSeek API Key</label>
            <input type="password" id="apiKey" placeholder="sk-...">
            <p class="hint">キーがない場合、簡易翻訳ボタンが表示されます(デモ用)。<br>Without a key, translation may be limited.</p>

            <label for="sourceLang">Input Language (話す言語)</label>
            <select id="sourceLang">
                <option value="zh-CN">Chinese (中国語)</option>
                <option value="en-US">English (英語)</option>
                <option value="ja-JP">Japanese (日本語)</option>
            </select>

            <label for="targetLang">Output Language (翻訳先)</label>
            <select id="targetLang">
                <option value="Japanese">Japanese (日本語)</option>
                <option value="English">English (英語)</option>
                <option value="Chinese">Chinese (中国語)</option>
            </select>

            <label for="translationMode">Mode</label>
            <select id="translationMode">
                <option value="deepseek">DeepSeek V3 (High Quality / Paid)</option>
                <option value="free">Free - MyMemory (Limited)</option>
                <option value="manual">Manual / None</option>
            </select>

            <div class="dialog-actions">
                <button value="cancel" class="btn-text">Cancel</button>
                <button value="save" id="saveSettings" class="btn-primary">Save</button>
            </div>
        </form>
    </dialog>

    <script src="script.js"></script>
</body>

</html>